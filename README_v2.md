# DriveUnit Bseries(ver 2.0)のドキュメント<br>
ver2.0の使い方，特性などについて解説していきます．<br>
**DIRの入力が反転されているので，ver1.0とは正転，逆転の入力が反対になっています．**<br>
不具合が見つかったら僕に連絡するかIssuesを投げていただけると助かります．

## 基板外形図<br>
**表**<br>
![image](https://user-images.githubusercontent.com/80198387/191909704-a31c348d-2af7-45b2-ad65-13e2a23591a7.png)<br>
<br>
**裏**<br>
![image](https://user-images.githubusercontent.com/80198387/191909916-40b41572-b584-40fb-99e5-1cd704760acc.png)<br>

基板サイズ:*65.68[mm]×51[mm]*

## ver1.0からの主な修正点
大きな変更から順に書いていきます．<br>
とても細かい変更も一応書いておきます．<br>
1. 入力が浮いても暴走しなくなった<br>
これが一番大きな改善点です．<br>
ロボコンにおいて恐らくロボットの暴走が一番避けたいことだと思うので...(ver1.0を使用していたときは別に暴走対策用の回路を作っていました)<br>

1. DIRの入力をゲートドライバICに合わせた<br>
ver1.0と同じ入力になるように組むよりも，PWMと同様にDIRの入力も反転したほうが部品点数が少なく済むなどのメリットがあったため，DIRも入力を反転しました．<br>
(絶縁用のフォトカプラで更に入力が反転されるので)結果的に，ゲートドライバICに入力されている信号はこのモータードライバに入力している信号と一致します．<br>
そのため，前モータードライバと異なりDIRが1で正回転，0で負回転です．<br>

1. ボタン入力が優先になった<br>
ver1.0はボタン入力とマイコン入力の優先順位が同じだったため，マイコン入力が特定の状態でないとボタンが正常に動かない~~クソ仕様~~でした．<br>
そのため今回の回路ではマイコン入力が任意の状態でもボタンが正常に動くように回路を組み直しました．<br>


1. ボタンとスライドスイッチの位置を逆にした<br>
ボタンを上から押しやすくするため，スライドスイッチよりも上にボタンを配置しました．

1. SAとSB，FF1とFF2の位置を逆にした<br>
ver1.0はFF1とFF2の位置がデータシートのFault Definitionsに載っている順と逆に書いてしまったため，エラーを吐いた時に間違えやすく，さらにシルクが小さすぎてどのLEDがFF1か分からなくなっていたため~~本当にゴミ~~でした．<br>
SAとSBについても，ボタンの配置と逆にしていたので左のボタンを押すと右のLEDが光るという仕様になっていました．<br>
そのため，これらのLEDの位置を逆にしました．

1. シルクとQRコードを大きくして読みやすくした<br>
シルクが小さすぎてはんだ付けの際やLEDを見る際などに非常に不便だったのでシルクを全体的に大きくしました．<br>
また，基板裏面のQRコードはアプリを使用すると(恐らくQRコードの補完機能で)読み取れるのですが，IPhoneのカメラアプリなどを使用して読み取ろうとする人が読み取れないと言っていたのでQRコードも大きくしました．<br>

## 使い方
ver1.0の共通点が多々あるので所々コピペしますが一応ver1.0のドキュメントを参照しなくてもわかるようにします．<br>
また，ver1.0と違うところはわかりやすいように💫で示します(~~きれい~~)．<br>
前モータードライバ(野獣)にはない機能があるので使用者は必ず確認してください．<br>
長くなるため折りたたみます．
<details><summary>使い方</summary>
  
  まずはLAP/SM切り替えスイッチについて説明していきます．
  - LAP/SM切り替えスイッチ
  ![image](https://user-images.githubusercontent.com/80198387/191911726-11384aca-9bdc-45bb-8d52-744c9ad349c3.png)
  このスイッチは名前の通り，LAP方式とSM方式を切り替えることできるスイッチです．<br>
基板にあるシルクの通り，スライドスイッチを"SM"の文字の方にスライドするとSM方式，"LAP"の文字の方にスライドするとLAP方式となります．<br>
SM方式を採用する場合にはPWMピンにはPWM信号を流し，DIRピンには回転方向の信号を流してください(下の表参照)<br>
LAP方式を採用する場合はPWMピンには何も繋げずに**DIRピンに**PWM信号を流してください．<br>
LAP/SM方式の場合の各ピンの真理値表は以下のようになっています．<br>

    |PWM|DIR|出力(SM)|
    |:---:|:---:|:---:|
    |1~100%|0|負回転💫|
    |1~100%|1|正回転💫|
    |0%|$\phi$|ブレーキ|

    |DIR|出力(LAP)|
    |:---:|:---:|
    |0~49%|負回転💫|
    |50%|無回転|
    |51~100%|正回転💫|